## 主从同步的定义

主从同步使得数据可以从一个数据库服务器复制到其他服务器上，在复制数据时，一个服务器充当**主服务器（master）**，其余的服务器则充当**从服务器（slave）**。

使用主从同步的好处：

* 在主服务器上执行修改，在从服务器上向外提供读功能，通过增加从服务器来**提高数据库性能**
* 在从服务器实现备份，**提高数据安全**
* 在主服务器上生成实时数据，从服务器备份后进行数据分析，**提高主服务器性能**

## 配置主从同步

#### 基本步骤

有很多种配置主从同步的方法，可以总结为如下的步骤：

1. 在主服务上，必须开启二进制日志机制和配置一个独立的 ID
2. 在每一台从服务器上，配置一个唯一的 ID，创建一个用来怎么复制主服务器数据的账户
3. 在开始复制进程前，在主服务器上记录二进制文件的位置信息
4. 如果在开始复制之前，数据库中已有数据，就必须先创建一个数据快照（可以使用 mysqldump 导出数据库，还在直接复制数据文件）
5. 配置从服务器要链接的主服务器的 IP 地址和登录授权，二进制日志文件名和位置

#### 具体步骤

如下在本机的两个 Ubuntu 虚拟机上配置主从同步。

如果在设置主从同步前，主服务器上已有大量数据，可以使用 `mysqldump` 进行数据备份并还原到从服务器，以实现数据复制。在主服务器上进行备份，执行命令

```shell
mysqldump -uroot -pmysql --all-databases --lock-all-tables > ~/Desktop/master_db.sql
# --all-databases 导出所有数据库
# --lock-all-tables 执行操作时锁住所有表
# ~/Desktop/master_db.sql 导出的备份数据的位置
```

然后将 `~/Desktop`下的 `master_db.sql` 文件移到从服务器上。

